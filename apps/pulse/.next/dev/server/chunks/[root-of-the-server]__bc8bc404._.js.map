{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Dell/Desktop/Segmento-app-website-dev/frontend/apps/pulse/app/api/%5B...path%5D/route.ts"],"sourcesContent":["/**\r\n * Catch-all API proxy route for Segmento Pulse.\r\n *\r\n * Problem: The backend CORS only allows localhost:3000.\r\n * Pulse now runs on localhost:3001, so direct browser fetches are blocked.\r\n *\r\n * Solution: All browser requests go to /api/* (same origin = no CORS).\r\n * This route forwards them server-side to the backend (serverâ†’server = no CORS).\r\n */\r\n\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nconst BACKEND_URL = process.env.NEXT_PUBLIC_PULSE_API_URL || 'http://localhost:8000';\r\n\r\nasync function proxyRequest(request: NextRequest, params: { path: string[] }) {\r\n    const path = params.path.join('/');\r\n    const searchParams = request.nextUrl.searchParams.toString();\r\n    const targetUrl = `${BACKEND_URL}/api/${path}${searchParams ? `?${searchParams}` : ''}`;\r\n\r\n    try {\r\n        const headers = new Headers();\r\n        // Forward content-type if present\r\n        const contentType = request.headers.get('content-type');\r\n        if (contentType) headers.set('content-type', contentType);\r\n\r\n        const fetchOptions: RequestInit = {\r\n            method: request.method,\r\n            headers,\r\n        };\r\n\r\n        // Forward body for non-GET requests\r\n        if (request.method !== 'GET' && request.method !== 'HEAD') {\r\n            fetchOptions.body = await request.text();\r\n        }\r\n\r\n        const response = await fetch(targetUrl, fetchOptions);\r\n        const data = await response.json();\r\n\r\n        return NextResponse.json(data, { status: response.status });\r\n    } catch (error) {\r\n        console.error(`[Proxy] Failed to reach backend at ${targetUrl}:`, error);\r\n        return NextResponse.json(\r\n            { error: 'Backend unavailable', detail: String(error) },\r\n            { status: 502 }\r\n        );\r\n    }\r\n}\r\n\r\nexport async function GET(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    return proxyRequest(request, await params);\r\n}\r\n\r\nexport async function POST(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    return proxyRequest(request, await params);\r\n}\r\n\r\nexport async function PUT(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    return proxyRequest(request, await params);\r\n}\r\n\r\nexport async function DELETE(\r\n    request: NextRequest,\r\n    { params }: { params: Promise<{ path: string[] }> }\r\n) {\r\n    return proxyRequest(request, await params);\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;;;CAQC,GAED;;AAEA,MAAM,cAAc,6DAAyC;AAE7D,eAAe,aAAa,OAAoB,EAAE,MAA0B;IACxE,MAAM,OAAO,OAAO,IAAI,CAAC,IAAI,CAAC;IAC9B,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY,CAAC,QAAQ;IAC1D,MAAM,YAAY,GAAG,YAAY,KAAK,EAAE,OAAO,eAAe,CAAC,CAAC,EAAE,cAAc,GAAG,IAAI;IAEvF,IAAI;QACA,MAAM,UAAU,IAAI;QACpB,kCAAkC;QAClC,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC;QACxC,IAAI,aAAa,QAAQ,GAAG,CAAC,gBAAgB;QAE7C,MAAM,eAA4B;YAC9B,QAAQ,QAAQ,MAAM;YACtB;QACJ;QAEA,oCAAoC;QACpC,IAAI,QAAQ,MAAM,KAAK,SAAS,QAAQ,MAAM,KAAK,QAAQ;YACvD,aAAa,IAAI,GAAG,MAAM,QAAQ,IAAI;QAC1C;QAEA,MAAM,WAAW,MAAM,MAAM,WAAW;QACxC,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ,SAAS,MAAM;QAAC;IAC7D,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,CAAC,mCAAmC,EAAE,UAAU,CAAC,CAAC,EAAE;QAClE,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;YAAuB,QAAQ,OAAO;QAAO,GACtD;YAAE,QAAQ;QAAI;IAEtB;AACJ;AAEO,eAAe,IAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,OAAO,aAAa,SAAS,MAAM;AACvC;AAEO,eAAe,KAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,OAAO,aAAa,SAAS,MAAM;AACvC;AAEO,eAAe,IAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,OAAO,aAAa,SAAS,MAAM;AACvC;AAEO,eAAe,OAClB,OAAoB,EACpB,EAAE,MAAM,EAA2C;IAEnD,OAAO,aAAa,SAAS,MAAM;AACvC"}}]
}